# 语言切换问题修复

## 🐛 问题描述

1. **首页点击中文/繁体中文没有反应**
2. **推荐提示词没有跟随语言切换**

## 🔍 根本原因

### 问题1：语言键不匹配
- `index.html` 使用：`zh-CN`、`zh-TW`
- `i18n.js` 使用：`zh`、`zh-tw`
- **结果**：点击按钮时找不到对应的翻译，无法切换

### 问题2：提示词未国际化
- `tool.html` 中推荐按钮的 `data-prompt` 属性硬编码为中文
- 切换语言后，按钮文本更新了，但 `data-prompt` 还是中文

## ✅ 修复方案

### 修复1：统一语言键（index.html）

```html
<!-- 修改前 -->
<div class="lang-option" data-lang="zh-CN">
<div class="lang-option" data-lang="zh-TW">

<!-- 修改后 -->
<div class="lang-option" data-lang="zh">
<div class="lang-option" data-lang="zh-tw">
```

### 修复2：提示词国际化（tool.html）

```html
<!-- 修改前 -->
<button class="suggestion-btn" data-prompt="一只可爱的橘猫...">

<!-- 修改后 -->
<button class="suggestion-btn" data-i18n-prompt="suggest.catPrompt">
```

### 修复3：添加处理逻辑（i18n.js）

```javascript
// 更新带有data-i18n-prompt属性的元素
document.querySelectorAll('[data-i18n-prompt]').forEach(element => {
    const key = element.getAttribute('data-i18n-prompt');
    const text = t(key);
    element.setAttribute('data-prompt', text);
    console.log(`[i18n] 更新提示词: ${key} = ${text.substring(0, 50)}...`);
});
```

### 修复4：更新脚本版本号

```html
<!-- 强制浏览器重新加载最新JS -->
<script src="js/i18n.js?v=20251101a"></script>
<script src="js/tool.js?v=20251101a"></script>
```

## 📦 修改的文件

| 文件 | 修改内容 |
|------|---------|
| `index.html` | 将 `data-lang="zh-CN"` 改为 `"zh"`，`"zh-TW"` 改为 `"zh-tw"` |
| `tool.html` | 将 `data-prompt` 改为 `data-i18n-prompt`，更新版本号 |
| `js/i18n.js` | 添加推荐提示词完整翻译，添加处理逻辑，添加调试日志 |
| `docs/提示词多语言功能说明.md` | 详细的功能说明文档 |
| `scripts/推送多语言提示词.bat` | 快速推送脚本 |

## 🚀 部署步骤

### 方式1：Git命令行

```bash
# 添加文件
git add index.html tool.html js/i18n.js docs/

# 提交
git commit -m "fix: 修复首页中文按钮无响应和提示词多语言问题

- 统一语言键：zh-CN→zh, zh-TW→zh-tw
- 推荐提示词支持多语言切换
- 添加调试日志
- 更新版本号强制刷新"

# 推送
git push origin main
```

### 方式2：使用批处理脚本

双击运行：`scripts\推送多语言提示词.bat`

### 方式3：GitHub Desktop

1. 打开 GitHub Desktop
2. 查看更改的文件
3. 填写提交说明
4. 点击 **Commit to main**
5. 点击 **Push origin**

## 🧪 测试步骤

### 测试1：首页语言切换
1. 访问首页
2. 点击右上角语言切换器
3. 点击"简体中文" - 应该切换成功
4. 点击"繁體中文" - 应该切换成功
5. 点击其他语言 - 都应该正常切换

### 测试2：推荐提示词多语言
1. 进入 Tool 页面
2. 当前语言是English
3. 点击"Cute Cat"按钮
4. 检查输入框：应该显示英文提示词
5. 切换到"简体中文"
6. 再次点击"可爱橘猫"按钮
7. 检查输入框：应该显示中文提示词

### 测试3：浏览器控制台
1. 按 F12 打开控制台
2. 切换语言
3. 应该看到类似日志：
```
[i18n] 更新提示词: suggest.catPrompt = A cute orange cat sitting on a windowsill...
[i18n] 更新提示词: suggest.cityPrompt = Futuristic cityscape, cyberpunk style...
```

## 📊 各语言对照表

| 语言 | 旧键值 | 新键值 | 说明 |
|------|--------|--------|------|
| 简体中文 | `zh-CN` | `zh` | ✅ 已统一 |
| 繁体中文 | `zh-TW` | `zh-tw` | ✅ 已统一 |
| 英语 | `en` | `en` | ✔ 无需修改 |
| 其他语言 | - | - | ✔ 保持不变 |

## 🎯 预期效果

1. ✅ 所有语言切换按钮都能正常工作
2. ✅ 推荐提示词随语言自动切换
3. ✅ 输入框placeholder随语言自动更新
4. ✅ 控制台输出调试信息便于诊断

## ⚠️ 注意事项

### 浏览器缓存
用户可能需要清除缓存或强制刷新：
- Windows: `Ctrl + F5`
- Mac: `Cmd + Shift + R`

### localStorage
如果用户之前保存了语言偏好，会优先使用保存的语言，而不是默认英文。

---

**修复时间**: 2025-11-01  
**状态**: ✅ 本地修复完成，待推送部署


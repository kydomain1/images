========================================
通义万相API代理服务器使用说明
========================================

⚠️ 重要：通义万相API不支持浏览器直接调用，必须通过后端服务器！

========================================
快速启动（3步）
========================================

第一步：安装Node.js
----------------------------------------
1. 访问：https://nodejs.org/
2. 下载并安装 LTS 版本（推荐 18.x 或 20.x）
3. 安装时勾选"Add to PATH"
4. 安装完成后重启电脑（可选）

验证安装：
  打开命令提示符（CMD）输入：
  node --version
  
  应该显示版本号，如：v18.17.0


第二步：安装依赖
----------------------------------------
方法A（推荐）：双击运行
  双击 "启动服务器.bat" 文件
  首次运行会自动安装依赖

方法B：手动安装
  1. 打开命令提示符（CMD）
  2. 进入项目目录：
     cd D:\images
  3. 安装依赖：
     npm install
  4. 等待安装完成（约1-2分钟）


第三步：启动服务器
----------------------------------------
方法A（推荐）：双击运行
  双击 "启动服务器.bat" 文件

方法B：手动启动
  1. 打开命令提示符（CMD）
  2. 进入项目目录：
     cd D:\images
  3. 启动服务器：
     node server.js

看到以下提示表示成功：
  ==================================================
  🎨 通义万相API代理服务器已启动
  ==================================================
  📡 服务地址: http://localhost:3000
  🔧 API端点: http://localhost:3000/api/tongyi/generate
  ==================================================


第四步：使用工具
----------------------------------------
1. 保持服务器运行（不要关闭CMD窗口）
2. 打开浏览器访问：
   http://localhost:3000/tool.html
3. 输入提示词，点击生成
4. 等待10-30秒查看结果


========================================
常见问题
========================================

Q1: 提示"node不是内部或外部命令"
A: Node.js未安装或未添加到PATH
   解决：重新安装Node.js，确保勾选"Add to PATH"

Q2: npm install 很慢
A: 网络问题，可以使用国内镜像：
   npm config set registry https://registry.npmmirror.com
   然后重新运行：npm install

Q3: 端口3000已被占用
A: 修改 server.js 第6行的端口号：
   const PORT = 3001; // 改成其他端口

Q4: 服务器启动后，tool.html打不开
A: 确保访问 http://localhost:3000/tool.html
   不是直接双击打开文件

Q5: 图片生成失败
A: 检查：
   1. API Key是否正确
   2. 服务器是否在运行
   3. 浏览器控制台是否有错误
   4. 免费额度是否用完


========================================
目录结构
========================================

D:\images\
├── server.js              # 后端服务器
├── package.json           # 项目配置
├── 启动服务器.bat         # 一键启动脚本（Windows）
├── tool.html              # 前端工具页面
├── index.html             # 首页
├── js/
│   ├── api-config.js      # API配置
│   ├── tongyi-api.js      # 通义万相API
│   └── tool.js            # 工具页面脚本
└── css/
    └── style.css          # 样式文件


========================================
停止服务器
========================================

方法1：在CMD窗口按 Ctrl + C
方法2：直接关闭CMD窗口


========================================
查看日志
========================================

服务器运行时会显示日志：
  收到生成请求: { prompt: '...', size: '1024*1024', count: 1 }
  提交任务到通义万相...
  任务已提交，Task ID: xxx
  轮询中 (1/60): RUNNING
  轮询中 (2/60): RUNNING
  生成成功，返回结果


========================================
查看API用量
========================================

访问：https://dashscope.console.aliyun.com/billing


========================================
需要帮助？
========================================

1. 查看详细文档：通义万相接入指南.md
2. 检查浏览器控制台错误（F12）
3. 检查服务器CMD窗口的日志
4. 确认Node.js版本 >= 14.0.0


